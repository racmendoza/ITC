<!DOCTYPE html>
<html>
  <head>
    <title>PLACEHOLDER SHOPPING CART TO PAYROLL 7:35</title>
  </head>
  <body onload="initcart()">
    <h1>Simple Shopping Cart Version #2 - Using HTML Tables to Display the Cart</h1>
    <br>
    <p>
      <a href="index.html">Back to Main Page</a>
    </p>
    <br>
    <p>
      <label for="name">Employee Name:</label>
        <input id="name" type="text" ">
      <label for="days">Days Worked:</label>
        <input id="days" type="number" ">
      <label for="price">Unit Price:</label>
        <input id="price" type="number" ">
      <label for="amount">Amount:</label>
        <input id="amount" type="number" readonly="">
      <button id="addtocart">Add to Cart</button>
    </p>
    <p>
      <label for="count">Employee Records:</label>
      <input id="count" type="number" readonly="">
      <button id="clearcart">Clear Cart</button>
      <label for="deleteCount">Delete Employee Record:</label>
      <input id="deleteCount"type="number">
      <button id="confirmDelete">Delete</button>
    </p>
    <p id="cart"></p>
  </body>
  <script>



    // Initialize cart CALLED ALSO IN BODY ONLOAD      
    function initcart(){
        cart=[];
        document.getElementById("count").value=cart.length;
        document.getElementById("cart").innerHTML="";

            
    }

    document.getElementById("days").addEventListener("keyup",()=>   
     {  
        computeamount();
     });

    document.getElementById("price").addEventListener("keyup",()=>   
     {  
        computeamount();
     });
  
    // Clear Cart
     document.getElementById("clearcart").addEventListener("click",()=>   
       {
        var toclear;

        toclear=confirm("Delete all Employee(s) from Record?");

        if (toclear) {
             initcart();
         }
            
      });

    // Add item to cart
  document.getElementById("addtocart").addEventListener("click",()=>   
       {
        
         var cartno = {
             "count": "1",
             "price": 0,
             "days": 1,
            "employeeCount" : function employeeCount(){
                 return Math.round(this.price*this.days*100)/100;  
               }
            };

          cartno.count=document.getElementById("name").value;
          cartno.days=document.getElementById("days").value;
          cartno.price=document.getElementById("price").value;

          console.log(cartno.count);
          console.log(cartno.days);
          console.log(cartno.price);


           cart.push(cartno);
          //cart[cart.length]=cartno;

          console.log(cart.length);
          document.getElementById("count").value=cart.length;

          showcart();

    });

    // Compute Amount per Item
    function computeamount() {
          var d,p,d;
          d = document.getElementById("days").value*1;
          p = document.getElementById("price").value*1;

          a = Math.round(d*p*100)/100;  // rounds off to 2 decimal places

          console.log(a);

          document.getElementById("amount").value=a;
        
    }    
    
    // Delete item from chart
  document.getElementById("confirmDelete").addEventListener("click",()=>   
      {
    
        var todelete;
        var employeeNo;

        employeeNo=document.getElementById("deleteCount").value;

        todelete=confirm("Delete Employee No. "+employeeNo+"?");

        if (todelete) {

            cart.splice(employeeNo-1,1);
            document.getElementById("count").value=cart.length;
             showcart();   
        }

    });

    // Show the contents of the cart
    function showcart(){

        var i,l,carttext,totalamount,ln;
        var theader,tbody,tb,tfooter;

    
        // Generate table header;
        theader ="<thead>";
        theader+="<tr>";
        theader+="<th>No.</th>";
        theader+='<th style="text-align:left" >Employee</th>';
        theader+="<th>Days Worked</th>";
        theader+='<th style="text-align:right">Price</th>';
        theader+="<th>Amount</th>";
        theader+="</tr>";
        theader+="</thead>";
        
        // Generate Table Body
        l = cart.length;
      
        
        for (i=0,totalamount=0,carttext="",tbody='';i<l;i++){
            ln=i+1;    
            tbody += "<tr>"
                +'<td>'+ln+' </td>'
                +'<td>'+cart[i].count+' </td>'
                +'<td style="text-align:right">'+cart[i].days+'</td>'
                +'<td style="text-align:right">'+cart[i].price+'</td>'
                +'<td style="text-align:right">'+cart[i].employeeCount()+'</td>'                
                +"</tr>";
                       
            totalamount+=cart[i].employeeCount();
          

        }

        //tbody += "</tbody>";

        // Generate table footer;
        tfooter ="<tfoot>";
        tfooter+="<tr>";
        tfooter+='<th style="text-align:left">'+cart.length+'</th>';
        tfooter+='<th style="text-align:left">Employees</th>';
        tfooter+='<th></th>';
        tfooter+='<th>Total Amount</th>';
        tfooter+='<th style="text-align:right">'+totalamount+'</th>';
        tfooter+="</tr>";
        tfooter+="</tfoot>";

       console.log(theader+tbody+tfooter);
        document.getElementById("cart").innerHTML=
           "<table>"+theader+tbody+tfooter+"</table>";


    }
  
// Global variable
var cart = []; 


  </script>
</html>
